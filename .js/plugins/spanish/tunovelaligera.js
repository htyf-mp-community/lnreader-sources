"use strict";var e=this&&this.__awaiter||function(e,a,t,n){return new(t||(t=Promise))((function(r,l){function i(e){try{s(n.next(e))}catch(e){l(e)}}function o(e){try{s(n.throw(e))}catch(e){l(e)}}function s(e){var a;e.done?r(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(i,o)}s((n=n.apply(e,a||[])).next())}))},a=this&&this.__generator||function(e,a){var t,n,r,l,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function o(o){return function(s){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;l&&(l=0,o[0]&&(i=0)),i;)try{if(t=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return i.label++,{value:o[1],done:0};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){i.label=o[1];break}if(6===o[0]&&i.label<r[1]){i.label=r[1],r=o;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(o);break}r[2]&&i.ops.pop(),i.trys.pop();continue}o=a.call(e,i)}catch(e){o=[6,e],n=0}finally{t=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:1}}([o,s])}}};Object.defineProperty(exports,"__esModule",{value:1});var t=require("cheerio"),n=require("@libs/fetch"),r=require("@libs/filterInputs"),l=require("@libs/defaultCover"),i=require("@libs/novelStatus"),o=function(){function o(){this.id="tunovelaligera",this.name="TuNovelaLigera",this.icon="src/es/tunovelaligera/icon.png",this.site="https://tunovelaligera.com",this.version="1.0.0",this.filters={order:{value:"rating",label:"Ordenado por",options:[{label:"Lo mas reciente",value:"latest"},{label:"A-Z",value:"alphabet"},{label:"Clasificación",value:"rating"},{label:"Trending",value:"trending"},{label:"Mas visto",value:"views"},{label:"Nuevo",value:"new-manga"}],type:r.FilterTypes.Picker},genres:{value:"",label:"Generos",options:[{label:"None",value:""},{label:"Acción",value:"accion"},{label:"Adulto",value:"adulto"},{label:"Artes Marciales",value:"artes-marciales"},{label:"Aventura",value:"aventura"},{label:"Ciencia Ficción",value:"ciencia-ficcion"},{label:"Comedia",value:"comedia"},{label:"Deportes",value:"deportes"},{label:"Drama",value:"drama"},{label:"Eastern Fantasy",value:"eastern-fantasy"},{label:"Ecchi",value:"ecchi"},{label:"FanFiction",value:"fan-fiction"},{label:"Fantasía",value:"fantasia"},{label:"Fantasía oriental",value:"fantasia-oriental"},{label:"Ficción Romántica",value:"ficcion-romantica"},{label:"Gender Bender",value:"gender-bender"},{label:"Harem",value:"harem"},{label:"Histórico",value:"historico"},{label:"Horror",value:"horror"},{label:"Josei",value:"josei"},{label:"Maduro",value:"maduro"},{label:"Mecha",value:"mecha"},{label:"Misterio",value:"misterio"},{label:"Novela China",value:"novela-china"},{label:"Novela FanFiction",value:"novela-fanfiction"},{label:"Novela Japonesa",value:"novela-japonesa"},{label:"Novela Koreana",value:"novela-koreana"},{label:"Novela ligera",value:"novela-ligera"},{label:"Novela original",value:"novela-original"},{label:"Novela Web",value:"web-novel"},{label:"Psicológico",value:"psicologico"},{label:"Realismo Mágico",value:"realismo-magico"},{label:"Recuento de vida",value:"recuento-de-vida"},{label:"Romance",value:"romance"},{label:"Romance contemporáneo",value:"romance-contemporaneo"},{label:"Romance Moderno",value:"romance-moderno"},{label:"Seinen",value:"seinen"},{label:"Shoujo",value:"shoujo"},{label:"Shounen",value:"shounen"},{label:"Sobrenatural",value:"sobrenatural"},{label:"Tragedia",value:"tragedia"},{label:"Vampiros",value:"vampiros"},{label:"Vida Escolar",value:"vida-escolar"},{label:"Western Fantasy",value:"western-fantasy"},{label:"Wuxia",value:"wuxia"},{label:"Xianxia",value:"xianxia"},{label:"Xuanhuan",value:"xuanhuan"},{label:"Yaoi",value:"yaoi"}],type:r.FilterTypes.Picker}}}return o.prototype.sleep=function(t){return e(this,void 0,void 0,(function(){return a(this,(function(e){return[2,new Promise((function(e){return setTimeout(e,t)}))]}))}))},o.prototype.popularNovels=function(r,l){var i,o,s=l.showLatestNovels,u=l.filters;return e(this,void 0,void 0,(function(){var e,l,c,v,h=this;return a(this,(function(a){switch(a.label){case 0:return e=this.site,e+=(null===(i=null==u?void 0:u.genres)||void 0===i?void 0:i.value)?"/genero"+u.genres.value:"/novelas",e+="/page/".concat(r,"?m_orderby="),e+=s?"latest":(null===(o=null==u?void 0:u.order)||void 0===o?void 0:o.value)||"rating",[4,(0,n.fetchApi)(e).then((function(e){return e.text()}))];case 1:return l=a.sent(),c=(0,t.load)(l),v=[],c(".page-item-detail").each((function(e,a){var t=c(a).find(".h5 > a").text(),n=c(a).find("img").attr("src"),r=c(a).find(".h5 > a").attr("href");r&&v.push({name:t,cover:n,path:r.replace(h.site,"")})})),[2,v]}}))}))},o.prototype.parseChapters=function(e){var a=this,t=[];return e("#lcp_instance_0 li").each((function(n,r){var l=e(r).find("a").text().replace(/[\t\n]/g,"").trim(),i=e(r).find("a").attr("href");i&&t.push({name:l,path:i.replace(a.site,"")})})),t},o.prototype.parseNovel=function(r){return e(this,void 0,void 0,(function(){var e,o,s,u,c,v;return a(this,(function(a){switch(a.label){case 0:return e=this.site+r,[4,(0,n.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return o=a.sent(),s=(0,t.load)(o),u=1,s("ul.lcp_paginator > li > a").each((function(){var e=Number(this.attribs.title);e&&e>u&&(u=e)})),c={path:r,chapters:[],totalPages:u,name:s(".post-title > h1").text().trim()},s(".manga-title-badges").remove(),v=s(".summary_image > a > img"),c.cover=v.attr("data-src")||v.attr("src")||v.attr("data-cfsrc")||l.defaultCover,s(".post-content_item").each((function(){var e=s(this).find(".summary-heading > h5").text().trim(),a=s(this).find(".summary-content").text().trim();switch(e){case"Género(s)":c.genres=a.replace(/, /g,",");break;case"Autor(es)":c.author=a;break;case"Estado":c.status=a.includes("OnGoing")||a.includes("Updating")?i.NovelStatus.Ongoing:i.NovelStatus.Completed}})),c.summary=s("div.summary__content > p").text().trim(),c.chapters=this.parseChapters(s),[2,c]}}))}))},o.prototype.parsePage=function(r,l){return e(this,void 0,void 0,(function(){var e,i,o,s,u,c,v,h,p;return a(this,(function(a){switch(a.label){case 0:return e=this.site+r,i=this.site+r+"?lcp_page0="+l,[4,(0,n.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return o=a.sent(),s=(0,t.load)(o),u=s("#lcp_instance_0 li").first(),c=s(u).find("a").attr("href"),v=s(u).find("a").text().replace(/[\t\n]/g,"").trim(),h=c?{path:c.replace(this.site,""),name:v}:void 0,[4,this.sleep(1e3)];case 3:return a.sent(),[4,(0,n.fetchApi)(i).then((function(e){return e.text()}))];case 4:return p=a.sent(),[2,{chapters:this.parseChapters((0,t.load)(p)),latestChapter:h}]}}))}))},o.prototype.parseChapter=function(r){return e(this,void 0,void 0,(function(){var e,l;return a(this,(function(a){switch(a.label){case 0:return[4,(0,n.fetchApi)(this.site+r)];case 1:return[4,a.sent().text()];case 2:return e=a.sent(),l=(0,t.load)(e),[2,l(".c-blog-post.post").html()||""]}}))}))},o.prototype.searchNovels=function(r){return e(this,void 0,void 0,(function(){var e,l,i,o,s=this;return a(this,(function(a){switch(a.label){case 0:return e="".concat(this.site,"/?s=").concat(r,"&post_type=wp-manga"),[4,(0,n.fetchApi)(e)];case 1:return[4,a.sent().text()];case 2:return l=a.sent(),i=(0,t.load)(l),o=[],i(".c-tabs-item__content").each((function(e,a){var t=i(a).find(".h4 > a").text(),n=i(a).find("img").attr("src"),r=i(a).find(".h4 > a").attr("href");r&&o.push({name:t,cover:n,path:r.replace(s.site,"")})})),[2,o]}}))}))},o.prototype.fetchImage=function(t){return e(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,(0,n.fetchFile)(t)];case 1:return[2,e.sent()]}}))}))},o}();exports.default=new o;